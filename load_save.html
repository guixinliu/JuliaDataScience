<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jose Storopoli" />
  <meta name="author" content="Rik Huijzer" />
  <meta name="author" content="Lazaro Alonso" />
  <title>加载和保存文件 - Julia Data Science</title>
  <link rel="shortcut icon" type="image/png" href="/JuliaDataScience/favicon.png"/>
  <link rel="stylesheet" href="/JuliaDataScience/style.css"/>
    <script src="/mousetrap.min.js"></script>
    <!-- TODO: Add url_prefix. -->
  <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("/JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="/JuliaDataScience/github.min.css">
<script src="/JuliaDataScience/highlight.min.js"></script>
<script src="/JuliaDataScience/julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        hljs.highlightElement(el);
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="/JuliaDataScience/">Julia Data Science</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="/JuliaDataScience/preface"><b>1</b> Preface</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/why_data_science"><b>1.1</b> What is Data Science?</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/engineering"><b>1.2</b> Software Engineering</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/acknowledgements"><b>1.3</b> Acknowledgements</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/why_julia"><b>2</b> Why Julia?</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/non-programmers"><b>2.1</b> For Non-Programmers</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/programmers"><b>2.2</b> For Programmers</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/julia_accomplish"><b>2.3</b> What Julia Aims to Accomplish?</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/julia_wild"><b>2.4</b> Julia in the Wild</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/julia_basics"><b>3</b> Julia Basics</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/ide"><b>3.1</b> Development Environments</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/syntax"><b>3.2</b> Language Syntax</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/data_structures"><b>3.3</b> Native Data Structures</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/filesystem"><b>3.4</b> Filesystem</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/standardlibrary"><b>3.5</b> Julia Standard Library</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/dataframes"><b>4</b> DataFrames.jl</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/load_save"><b>4.1</b> 加载和保存文件</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/index-and-summarize"><b>4.2</b> Index and Summarize</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/filter_subset"><b>4.3</b> Filter and Subset</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/select"><b>4.4</b> Select</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/missing_data"><b>4.5</b> Types and Missing Data</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/join"><b>4.6</b> Join</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/variable-transformations"><b>4.7</b> Variable Transformations</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/groupby_combine"><b>4.8</b> Groupby 和 Combine</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/df_performance"><b>4.9</b> Performance</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/DataVisualizationMakie"><b>5</b> 使用 Makie.jl 做数据可视化</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/cairomakie"><b>5.1</b> CairoMakie.jl</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/datavisMakie_attributes"><b>5.2</b> 属性</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/themes"><b>5.3</b> 主题</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/使用-latexstrings.jl"><b>5.4</b> 使用 LaTeXStrings.jl</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/makie_colors"><b>5.5</b> 颜色和颜色图（Colormap）</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/makie_layouts"><b>5.6</b> 布局</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/appendix"><b>6</b> Appendix</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/appendix_pkg"><b>6.1</b> Packages Versions</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/notation"><b>6.2</b> Notation</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/references"><b></b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="4.1" id="sec:load_save"><span class="header-section-number">4.1</span> 加载和保存文件</h2>
<p>仅在 Julia 程序中使用数据非常有局限性，通常还需要能够加载或保存数据。 因此，本节主要讨论如何存储文件到硬盘和从硬盘读取文件。 我们重点关注 CSV 和 Excel 这两类最常见的数据文件格式，分别参见 Section <a href="/JuliaDataScience/load_save#sec:csv">4.1.1</a> 和 Section <a href="/JuliaDataScience/load_save#sec:excel">4.1.2</a>。</p>
<h3 data-number="4.1.1" id="sec:csv"><span class="header-section-number">4.1.1</span> CSV</h3>
<p><strong>C</strong>omma-<strong>s</strong>eparated-<strong>v</strong>alues (CSV) 文件是非常有效的表格存储方式。 CSV 文件相比其他数据存储文件有两点优势。首先，正如名称所指示的那样，它使用逗号<code>,</code>来分隔存储值。此首字母缩写词也被用作文件扩展名。因此，请确保使用“.csv”扩展名（例如“myfile.csv”）保存文件。为了演示 CSV 文件的结构，安装 <a href="http://csv.juliadata.org/latest/"><code>CSV.jl</code></a> 包：</p>
<pre><code>julia&gt; ]

pkg&gt; add CSV</code></pre>
<p>并且通过以下方式导入：</p>
<pre><code>using CSV</code></pre>
<p>现在可使用之前的数据：</p>
<pre class="language-julia"><code>grades_2020()</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>并在写入后从文件中读取：</p>
<pre class="language-julia"><code>function write_grades_csv()
    path = &quot;grades.csv&quot;
    CSV.write(path, grades_2020())
end</code></pre>
<pre class="language-julia"><code>path = write_grades_csv()
read(path, String)</code></pre>
<pre class="output"><code>name,grade_2020
Sally,1.0
Bob,5.0
Alice,8.5
Hank,4.0
</code></pre>
<p>上文还能看到 CSV 数据格式的第二个好处：可以使用简单的文本编辑器读取数据。 这与许多需要专有软件的其他数据格式不同，例如 Excel。</p>
<p>这很有效，但是如果我们的数据 <strong>包含逗号 <code>,</code></strong> 作为值怎么办？ 如果我们天真地用逗号写入数据，那么文件将很难转换回表格。 幸运的是，<code>CSV.jl</code> 会自动处理此问题。 考虑以下带逗号<code>,</code>的数据：</p>
<pre class="language-julia"><code>function grades_with_commas()
    df = grades_2020()
    df[3, :name] = &quot;Alice,&quot;
    df
end
grades_with_commas()</code></pre>
<div id="tbl:grades_with_commas">
<table>
<caption>Table 5: Grades with commas.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Alice,</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
</div>
<p>如果写入文件，将得到：</p>
<pre class="language-julia"><code>function write_comma_csv()
    path = &quot;grades-commas.csv&quot;
    CSV.write(path, grades_with_commas())
end
path = write_comma_csv()
read(path, String)</code></pre>
<pre class="output"><code>name,grade_2020
Sally,1.0
Bob,5.0
&quot;Alice,&quot;,8.5
Hank,4.0
</code></pre>
<p>因此，<code>CSV.jl</code> 在包含逗号的值周围添加引号 <code>"</code>。 解决此问题的另一种常见方法是将数据写入 <strong>t</strong>ab-<strong>s</strong>eparated <strong>v</strong>alues (TSV) 文件格式。 该格式假设数据不包含制表符，这一点在大多数情况下是成立的。</p>
<p>另请注意，也可以使用简单的文本编辑器读取 TSV 文件，这些文件使用“.tsv”扩展名。</p>
<pre class="language-julia"><code>function write_comma_tsv()
    path = &quot;grades-comma.tsv&quot;
    CSV.write(path, grades_with_commas(); delim=&#39;\t&#39;)
end
read(write_comma_tsv(), String)</code></pre>
<pre class="output"><code>name    grade_2020
Sally   1.0
Bob 5.0
Alice,  8.5
Hank    4.0
</code></pre>
<p>像 CSV 和 TSV 这样的文本文件格式还可以使用其他分割符，例如分号“;”，空格“ ”，甚至是像“π”这样不寻常的字符。</p>
<pre class="language-julia"><code>function write_space_separated()
    path = &quot;grades-space-separated.csv&quot;
    CSV.write(path, grades_2020(); delim=&#39; &#39;)
end
read(write_space_separated(), String)</code></pre>
<pre class="output"><code>name grade_2020
Sally 1.0
Bob 5.0
Alice 8.5
Hank 4.0
</code></pre>
<p>按照惯例，最好还是为文件指定特殊的分隔符，例如“;”，“.csv”扩展名。</p>
<p>使用 <code>CSV.jl</code> 加载 CSV 文件的方式与此类似。 您可以使用 <code>CSV.read</code> 并指定您想要的输出格式。 这里指定为<code>DataFrame</code>。</p>
<pre class="language-julia"><code>path = write_grades_csv()
CSV.read(path, DataFrame)</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>方便地，<code>CSV.jl</code>将自动推断列类型：</p>
<pre class="language-julia"><code>path = write_grades_csv()
df = CSV.read(path, DataFrame)</code></pre>
<pre class="output"><code>4×2 DataFrame
 Row │ name     grade_2020
     │ String7  Float64
─────┼─────────────────────
   1 │ Sally           1.0
   2 │ Bob             5.0
   3 │ Alice           8.5
   4 │ Hank            4.0</code></pre>
<p>它甚至适用于更复杂的数据：</p>
<pre class="language-julia"><code>my_data = &quot;&quot;&quot;
    a,b,c,d,e
    Kim,2018-02-03,3,4.0,2018-02-03T10:00
    &quot;&quot;&quot;
path = &quot;my_data.csv&quot;
write(path, my_data)
df = CSV.read(path, DataFrame)</code></pre>
<pre class="output"><code>1×5 DataFrame
 Row │ a        b           c      d        e
     │ String3  Date        Int64  Float64  DateTime
─────┼──────────────────────────────────────────────────────────
   1 │ Kim      2018-02-03      3      4.0  2018-02-03T10:00:00</code></pre>
<p>这些CSV基础应该涵盖大多数用例。 关于更多信息，请参阅<a href="https://csv.juliadata.org/stable"><code>CSV.jl</code> 文档</a>尤其是<a href="https://csv.juliadata.org/stable/#CSV.File"><code>CSV.File</code> 构建 docstring</a>。</p>
<h3 data-number="4.1.2" id="sec:excel"><span class="header-section-number">4.1.2</span> Excel</h3>
<p>多个 Julia 包可以读取 Excel 文件。 本节将只讨论 <a href="https://github.com/felipenoris/XLSX.jl"><code>XLSX.jl</code></a>，因为它是 Julia 生态系统中处理 Excel 数据的最积极维护的包。 另外一个优点是，<code>XLSX.jl</code> 是用纯 Julia 编写的，这使得可以轻松地检查和理解指令背后发生的事情。</p>
<p>加载 <code>XLSX.jl</code> 的方式是</p>
<pre><code>using XLSX:
    eachtablerow,
    readxlsx,
    writetable</code></pre>
<p>为了写入文件，我们为数据和列名定义一个辅助函数：</p>
<pre class="language-julia"><code>function write_xlsx(name, df::DataFrame)
    path = &quot;$name.xlsx&quot;
    data = collect(eachcol(df))
    cols = names(df)
    writetable(path, data, cols)
end</code></pre>
<p>现在，可以轻松地将成绩写入 Excel 文件：</p>
<pre class="language-julia"><code>function write_grades_xlsx()
    path = &quot;grades&quot;
    write_xlsx(path, grades_2020())
    &quot;$path.xlsx&quot;
end</code></pre>
<p>当成绩被读取回来时，我们将看到 <code>XLSX.jl</code> 将数据放在 <code>XLSXFile</code> 类型中，并且可以像访问 <code>Dict</code> 一样访问所需的 <code>sheet</code>：</p>
<pre class="language-julia"><code>path = write_grades_xlsx()
xf = readxlsx(path)</code></pre>
<pre class="output"><code>XLSXFile(&quot;grades.xlsx&quot;) containing 1 Worksheet
            sheetname size          range        
-------------------------------------------------
               Sheet1 5x2           A1:B5        
</code></pre>
<pre class="language-julia"><code>xf = readxlsx(write_grades_xlsx())
sheet = xf[&quot;Sheet1&quot;]
eachtablerow(sheet) |&gt; DataFrame</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>请注意，本节只介绍了<code>XLSX.jl</code>的基础知识，但它还提供了更强大的用法和自定义功能。 有关更多信息和选项，请参阅<a href="https://felipenoris.github.io/XLSX.jl/stable/"><code>XLSX.jl</code> 文档</a>.</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-1" href="/JuliaDataScience/dataframes"><b>4</b> DataFrames.jl</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="/JuliaDataScience/index-and-summarize"><b>4.2</b> Index and Summarize</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Jose Storopoli, Rik Huijzer, Lazaro Alonso
</div>
</div>
</div>
</body>
</html>