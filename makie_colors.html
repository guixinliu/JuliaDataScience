<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jose Storopoli" />
  <meta name="author" content="Rik Huijzer" />
  <meta name="author" content="Lazaro Alonso" />
  <title>颜色和颜色图（Colormap） - Julia Data Science</title>
  <link rel="shortcut icon" type="image/png" href="/JuliaDataScience/favicon.png"/>
  <link rel="stylesheet" href="/JuliaDataScience/style.css"/>
    <script src="/mousetrap.min.js"></script>
    <!-- TODO: Add url_prefix. -->
  <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("/JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="/JuliaDataScience/github.min.css">
<script src="/JuliaDataScience/highlight.min.js"></script>
<script src="/JuliaDataScience/julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        hljs.highlightElement(el);
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="/JuliaDataScience/">Julia Data Science</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="/JuliaDataScience/preface"><b>1</b> Preface</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/why_data_science"><b>1.1</b> What is Data Science?</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/engineering"><b>1.2</b> Software Engineering</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/acknowledgements"><b>1.3</b> Acknowledgements</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/why_julia"><b>2</b> Why Julia?</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/non-programmers"><b>2.1</b> For Non-Programmers</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/programmers"><b>2.2</b> For Programmers</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/julia_accomplish"><b>2.3</b> What Julia Aims to Accomplish?</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/julia_wild"><b>2.4</b> Julia in the Wild</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/julia_basics"><b>3</b> Julia Basics</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/ide"><b>3.1</b> Development Environments</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/syntax"><b>3.2</b> Language Syntax</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/data_structures"><b>3.3</b> Native Data Structures</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/filesystem"><b>3.4</b> Filesystem</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/standardlibrary"><b>3.5</b> Julia Standard Library</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/dataframes"><b>4</b> DataFrames.jl</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/load_save"><b>4.1</b> 加载和保存文件</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/index-and-summarize"><b>4.2</b> Index and Summarize</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/filter_subset"><b>4.3</b> Filter and Subset</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/select"><b>4.4</b> Select</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/missing_data"><b>4.5</b> Types and Missing Data</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/join"><b>4.6</b> Join</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/variable-transformations"><b>4.7</b> Variable Transformations</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/groupby_combine"><b>4.8</b> Groupby 和 Combine</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/df_performance"><b>4.9</b> Performance</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/DataVisualizationMakie"><b>5</b> 使用 Makie.jl 做数据可视化</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/cairomakie"><b>5.1</b> CairoMakie.jl</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/datavisMakie_attributes"><b>5.2</b> 属性</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/themes"><b>5.3</b> 主题</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/使用-latexstrings.jl"><b>5.4</b> 使用 LaTeXStrings.jl</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/makie_colors"><b>5.5</b> 颜色和颜色图（Colormap）</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/makie_layouts"><b>5.6</b> 布局</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/appendix"><b>6</b> Appendix</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/appendix_pkg"><b>6.1</b> Packages Versions</a></li>
<li><a class="menu-level-2" href="/JuliaDataScience/notation"><b>6.2</b> Notation</a></li>
<li><a class="menu-level-1" href="/JuliaDataScience/references"><b></b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="5.5" id="sec:makie_colors"><span class="header-section-number">5.5</span> 颜色和颜色图（Colormap）</h2>
<p>在展示结果时，其中重要的一步是为图选择一组合适的颜色或 colorbar。 <code>Makie.jl</code> 支持使用 <a href="https://github.com/JuliaGraphics/Colors.jl">Colors.jl</a> ，因此你可以使用 <a href="https://juliagraphics.github.io/Colors.jl/latest/namedcolors/">named colors</a> 而不是传递 <code>RGB</code> 或 <code>RGBA</code> 值。 另外，也可以使用 <a href="https://github.com/JuliaGraphics/ColorSchemes.jl">ColorSchemes.jl</a> 和 <a href="https://github.com/peterkovesi/PerceptualColourMaps.jl">PerceptualColourMaps.jl</a> 中的颜色图。 值得了解的是，可以使用 <code>Reverse(:colormap_name)</code> 反转颜色图 ，也可以通过 <code>color=(:red,0.5)</code> and <code>colormap=(:viridis, 0.5)</code> 获得透明的颜色或颜色图。</p>
<p>下文介绍不同的用例。 接下来使用新的颜色和颜色栏（Colorbar）调色盘来创建自定义主题。</p>
<p>默认情况下， <code>Makie.jl</code> 已经预定义一组颜色，可以循环使用该组颜色。 之前的图因此并未设置任何特定颜色。 覆盖这些默认颜色的方法是，在绘图函数中调用 <code>color</code> 关键字并使用 <code>Symbol</code> 或 <code>String</code> 指定新的颜色。 该操作如下所示：</p>
<pre class="language-julia"><code>function set_colors_and_cycle()
    # Epicycloid lines
    x(r, k, θ) = r * (k .+ 1.0) .* cos.(θ) .- r * cos.((k .+ 1.0) .* θ)
    y(r, k, θ) = r * (k .+ 1.0) .* sin.(θ) .- r * sin.((k .+ 1.0) .* θ)
    θ = LinRange(0, 6.2π, 1000)
    axis = (; xlabel=L&quot;x(\theta)&quot;, ylabel=L&quot;y(\theta)&quot;,
        title=&quot;Epicycloid&quot;, aspect=DataAspect())
    figure = (; resolution=(600, 400), font=&quot;CMU Serif&quot;)
    fig, ax, _ = lines(x(1, 1, θ), y(1, 1, θ); color=&quot;firebrick1&quot;, # string
        label=L&quot;1.0&quot;, axis=axis, figure=figure)
    lines!(ax, x(4, 2, θ), y(4, 2, θ); color=:royalblue1, #symbol
        label=L&quot;2.0&quot;)
    for k = 2.5:0.5:5.5
        lines!(ax, x(2k, k, θ), y(2k, k, θ); label=latexstring(&quot;$(k)&quot;)) #cycle
    end
    Legend(fig[1, 2], ax, latexstring(&quot;k, r = 2k&quot;), merge=true)
    fig
end
set_colors_and_cycle()</code></pre>
<figure>
<img src="/JuliaDataScience/im/JDS_set_colors_and_cycle_.svg" id="fig:set_colors_and_cycle" alt="Figure 21: Set colors and cycle." /><figcaption aria-hidden="true">Figure 21: Set colors and cycle.</figcaption>
</figure>
<p>这里通过<code>color</code> 关键字指定了上例前两条曲线的颜色。 其余使用默认的颜色集。 稍后将学习如何使用自定义颜色循环。</p>
<p>关于颜色图，我们已经非常熟悉用于热力图和散点图的 <code>colormap</code>。下面展示的是，颜色图也可以像颜色那样通过 <code>Symbol</code> 或 <code>String</code> 进行指定。 此外，也可以是 <code>RGB</code> 颜色的向量。 下面是第一个例子，通过 <code>Symbol</code>， <code>String</code> 和分类值的 <code>cgrad</code> 来指定颜色图。 输入 <code>?cgrad</code> 查看更多信息。</p>
<pre class="language-julia"><code>figure = (; resolution=(600, 400), font=&quot;CMU Serif&quot;)
axis = (; xlabel=L&quot;x&quot;, ylabel=L&quot;y&quot;, aspect=DataAspect())
fig, ax, pltobj = heatmap(rand(20, 20); colorrange=(0, 1),
    colormap=Reverse(:viridis), axis=axis, figure=figure)
Colorbar(fig[1, 2], pltobj, label = &quot;Reverse colormap Sequential&quot;)
fig</code></pre>
<figure>
<img src="/JuliaDataScience/im/Reverse_colormap_sequential.svg" id="fig:Reverse_colormap_sequential" style="width:60.0%" alt="Figure 22: Reverse colormap sequential and colorrange." /><figcaption aria-hidden="true">Figure 22: Reverse colormap sequential and colorrange.</figcaption>
</figure>
<p>当设置 <code>colorrange</code> 后，超出此范围的颜色值会被相应地设置为颜色图的第一种和最后一种颜色。 但是，有时最好自行指定两端的颜色。这可以通过 <code>highclip</code> 和 <code>lowclip</code> 实现：</p>
<pre><code>using ColorSchemes</code></pre>
<pre class="language-julia"><code>figure = (; resolution=(600, 400), font=&quot;CMU Serif&quot;)
axis = (; xlabel=L&quot;x&quot;, ylabel=L&quot;y&quot;, aspect=DataAspect())
fig, ax, pltobj=heatmap(randn(20, 20); colorrange=(-2, 2),
    colormap=&quot;diverging_rainbow_bgymr_45_85_c67_n256&quot;,
    highclip=:black, lowclip=:white, axis=axis, figure=figure)
Colorbar(fig[1, 2], pltobj, label = &quot;Diverging colormap&quot;)
fig</code></pre>
<figure>
<img src="/JuliaDataScience/im/diverging_colormap.svg" id="fig:diverging_colormap" style="width:60.0%" alt="Figure 23: Diverging Colormap with low and high clip." /><figcaption aria-hidden="true">Figure 23: Diverging Colormap with low and high clip.</figcaption>
</figure>
<p>另外 <code>RGB</code> 向量也是合法的选项。 在下面的例子中， 你可以传递一个自定义颜色图 <em>perse</em> 或使用 <code>cgrad</code> 来创建分类值的 <code>Colorbar</code>。</p>
<pre><code>using Colors, ColorSchemes</code></pre>
<pre class="language-julia"><code>figure = (; resolution=(600, 400), font=&quot;CMU Serif&quot;)
axis = (; xlabel=L&quot;x&quot;, ylabel=L&quot;y&quot;, aspect=DataAspect())
cmap = ColorScheme(range(colorant&quot;red&quot;, colorant&quot;green&quot;, length=3))
mygrays = ColorScheme([RGB{Float64}(i, i, i) for i in [0.0, 0.5, 1.0]])
fig, ax, pltobj = heatmap(rand(-1:1, 20, 20);
    colormap=cgrad(mygrays, 3, categorical=true, rev=true), # cgrad and Symbol, mygrays,
    axis=axis, figure=figure)
cbar = Colorbar(fig[1, 2], pltobj, label=&quot;Categories&quot;)
cbar.ticks = ([-0.66, 0, 0.66], [&quot;-1&quot;, &quot;0&quot;, &quot;1&quot;])
fig</code></pre>
<figure>
<img src="/JuliaDataScience/im/categorical_colormap.svg" id="fig:categorical_colormap" style="width:60.0%" alt="Figure 24: Categorical Colormap." /><figcaption aria-hidden="true">Figure 24: Categorical Colormap.</figcaption>
</figure>
<p>最后，分类值的颜色栏标签默认不在每种颜色间居中。 添加自定义标签可修复此问题，即 <code>cbar.ticks = (positions, ticks)</code>。 最后一种情况是传递颜色的元组给 <code>colormap</code>，其中颜色可以通过 <code>Symbol</code>， <code>String</code> 或它们的混合指定。 然后将会得到这两组颜色间的插值颜色图。</p>
<p>另外，也支持十六进制编码的颜色作为输入。因此作为示范，下例将在热力图上放置一个半透明的标记。</p>
<pre class="language-julia"><code>figure = (; resolution=(600, 400), font=&quot;CMU Serif&quot;)
axis = (; xlabel=L&quot;x&quot;, ylabel=L&quot;y&quot;, aspect=DataAspect())
fig, ax, pltobj = heatmap(rand(20, 20); colorrange=(0, 1),
    colormap=(:red, &quot;black&quot;), axis=axis, figure=figure)
scatter!(ax, [11], [11], color=(&quot;#C0C0C0&quot;, 0.5), markersize=150)
Colorbar(fig[1, 2], pltobj, label=&quot;2 colors&quot;)
fig</code></pre>
<figure>
<img src="/JuliaDataScience/im/colormap_two_colors.svg" id="fig:colormap_two_colors" style="width:60.0%" alt="Figure 25: Colormap from two colors." /><figcaption aria-hidden="true">Figure 25: Colormap from two colors.</figcaption>
</figure>
<h3 data-number="5.5.1" id="自定义颜色循环"><span class="header-section-number">5.5.1</span> 自定义颜色循环</h3>
<p>可以通过新的颜色循环定义全局 <code>Theme</code> ，但通常 <strong>不建议</strong> 这样做。 更好的做法是定义新的主题并像上节那样使用它。 定义带有 <code>:color</code>， <code>:linestyle</code>， <code>:marker</code> 属性的新 <code>cycle</code> 和默认的 <code>colormap</code> 。 下面为之前的 <code>publication_theme</code> 增加一些新的属性。</p>
<pre class="language-julia"><code>function new_cycle_theme()
    # https://nanx.me/ggsci/reference/pal_locuszoom.html
    my_colors = [&quot;#D43F3AFF&quot;, &quot;#EEA236FF&quot;, &quot;#5CB85CFF&quot;, &quot;#46B8DAFF&quot;,
        &quot;#357EBDFF&quot;, &quot;#9632B8FF&quot;, &quot;#B8B8B8FF&quot;]
    cycle = Cycle([:color, :linestyle, :marker], covary=true) # alltogether
    my_markers = [:circle, :rect, :utriangle, :dtriangle, :diamond,
        :pentagon, :cross, :xcross]
    my_linestyle = [nothing, :dash, :dot, :dashdot, :dashdotdot]
    Theme(
        fontsize=16, font=&quot;CMU Serif&quot;,
        colormap=:linear_bmy_10_95_c78_n256,
        palette=(color=my_colors, marker=my_markers, linestyle=my_linestyle),
        Lines=(cycle=cycle,), Scatter=(cycle=cycle,),
        Axis=(xlabelsize=20, xgridstyle=:dash, ygridstyle=:dash,
            xtickalign=1, ytickalign=1, yticksize=10, xticksize=10,
            xlabelpadding=-5, xlabel=&quot;x&quot;, ylabel=&quot;y&quot;),
        Legend=(framecolor=(:black, 0.5), bgcolor=(:white, 0.5)),
        Colorbar=(ticksize=16, tickalign=1, spinewidth=0.5),
    )
end</code></pre>
<p>然后将它应用到绘图函数中，如下所示:</p>
<pre class="language-julia"><code>function scatters_and_lines()
    x = collect(0:10)
    xh = LinRange(4, 6, 25)
    yh = LinRange(70, 95, 25)
    h = randn(25, 25)
    fig = Figure(resolution=(600, 400), font=&quot;CMU Serif&quot;)
    ax = Axis(fig[1, 1], xlabel=L&quot;x&quot;, ylabel=L&quot;f(x,a)&quot;)
    for i in x
        lines!(ax, x, i .* x; label=latexstring(&quot;$(i) x&quot;))
        scatter!(ax, x, i .* x; markersize=13, strokewidth=0.25,
            label=latexstring(&quot;$(i) x&quot;))
    end
    hm = heatmap!(xh, yh, h)
    axislegend(L&quot;f(x)&quot;; merge=true, position=:lt, nbanks=2, labelsize=14)
    Colorbar(fig[1, 2], hm, label=&quot;new default colormap&quot;)
    limits!(ax, -0.5, 10.5, -5, 105)
    colgap!(fig.layout, 5)
    fig
end</code></pre>
<pre class="language-julia"><code>with_theme(scatters_and_lines, new_cycle_theme())</code></pre>
<figure>
<img src="/JuliaDataScience/im/custom_cycle.svg" id="fig:custom_cycle" style="width:60.0%" alt="Figure 26: Custom theme with new cycle and colormap." /><figcaption aria-hidden="true">Figure 26: Custom theme with new cycle and colormap.</figcaption>
</figure>
<p>此时，通过颜色，曲线样式，标记和颜色图，你已经能够 <strong>完全控制</strong> 绘图结果。 下一部分将讨论如何管理和控制 <strong>布局</strong>。</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="/JuliaDataScience/使用-latexstrings.jl"><b>5.4</b> 使用 LaTeXStrings.jl</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="/JuliaDataScience/makie_layouts"><b>5.6</b> 布局</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Jose Storopoli, Rik Huijzer, Lazaro Alonso
</div>
</div>
</div>
</body>
</html>